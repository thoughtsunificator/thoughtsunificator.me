<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Creating a Github action for a Node.js 14+ project | thoughtsunificator.me</title><link href="/main.bundle.css" rel="stylesheet" type="text/css"><link href="/manifest.webmanifest" rel="manifest"></head><body><header id="header"><h2>a boundless expression of thoughts</h2><nav><a href="/">Home</a><a href="/archive/">Archive</a><a href="/tags/">Tags</a><a href="/about/">About</a></nav></header><main id="main"><h2 class="title">Creating a Github action for a Node.js 14+ project</h2><article class="full post"><div class="metas"><time datetime="2021-09-25T00:00:00.000Z">25 September 2021</time><div class="tags"><a href="/tags/github/" class="tag">#github</a><a href="/tags/ci/cd/" class="tag">#CI/CD</a></div></div><div id="post-content"><h2 id="introduction" tabindex="-1">Introduction</h2><p>Currently it is <a href="https://github.com/actions/runner/issues/772" rel="noopener noreferrer" target="_blank" class="external">not possible</a> to create a <a href="https://docs.github.com/en/actions/creating-actions/creating-a-javascript-action" rel="noopener noreferrer" target="_blank" class="external">JavaScript action</a> with a version of nodejs other than 12.</p><p>This article attempt to provide a solution to this very issue.</p><h2 id="workaround" tabindex="-1">Workaround</h2><p>First if you don’t know the basics of Github Actions I recommend you go read the <a href="https://docs.github.com/en/actions/creating-actions/about-custom-actions" rel="noopener noreferrer" target="_blank" class="external">Starting Guide</a>.</p><p>So how do I use a version of nodejs > 12? You can do so by creating a <a href="https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action" rel="noopener noreferrer" target="_blank" class="external">Docker container action</a> with the <a href="https://hub.docker.com/_/node" rel="noopener noreferrer" target="_blank" class="external">node:16-alpine</a> image.</p><h3 id="action.yml" tabindex="-1">action.yml</h3><pre class="language-yaml"><code class="language-yaml"><span class="token comment"># See https://docs.github.com/en/actions/creating-actions/metadata-syntax-for-github-actions for more information about the action.yml syntax</span><br><span class="token punctuation">---</span><br><span class="token atrule key">name</span><span class="token punctuation">:</span> <span class="token string">'My Action'</span><br><span class="token atrule key">description</span><span class="token punctuation">:</span> <span class="token string">'What it does..'</span><br><span class="token atrule key">inputs</span><span class="token punctuation">:</span><br>	<span class="token atrule key">your-name</span><span class="token punctuation">:</span><br>		<span class="token atrule key">description</span><span class="token punctuation">:</span> <span class="token string">'Your name'</span><br>		<span class="token atrule key">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><br><span class="token atrule key">runs</span><span class="token punctuation">:</span><br>	<span class="token atrule key">using</span><span class="token punctuation">:</span> <span class="token string">'docker'</span><br>	<span class="token atrule key">image</span><span class="token punctuation">:</span> <span class="token string">'Dockerfile'</span><br></code></pre><h3 id="dockerfile" tabindex="-1">Dockerfile</h3><pre class="language-yaml"><code class="language-yaml"><span class="token comment"># This Dockerfile is inspired from the official document see https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action</span><br>FROM node<span class="token punctuation">:</span>16<span class="token punctuation">-</span>alpine <span class="token comment"># you can the version of your liking see https://hub.docker.com/_/node for more information</span><br>COPY github<span class="token punctuation">-</span>action<span class="token punctuation">-</span>src /github/github<span class="token punctuation">-</span>action<span class="token punctuation">-</span>src <span class="token comment"># we need our Github action source files to be available inside the container so let's copy them to "/github/github-action-src" for now.</span><br>COPY entrypoint.sh /entrypoint.sh<br>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"/entrypoint.sh"</span><span class="token punctuation">]</span></code></pre><h3 id="entrypoint.sh" tabindex="-1">entrypoint.sh</h3><pre class="language-yaml"><code class="language-yaml"><span class="token comment">#!/bin/sh -l</span><br><br><span class="token comment"># let's create a specific folder for the source files of our github action</span><br><br>mkdir github<span class="token punctuation">-</span>action<span class="token punctuation">-</span>src <span class="token comment"># "github/github-action-src" is the folder we put our Github Action source files into using our Dockerfile</span><br>cp <span class="token punctuation">-</span>r /github/github<span class="token punctuation">-</span>action<span class="token punctuation">-</span>src . <span class="token comment"># now let's copy that folder into the folder for the entire repository "/github/workspace"</span><br><br><span class="token comment"># as we are currently inside the github workspace (/github/workspace) containing the source files of the entire repository</span><br><span class="token comment"># we will need to cd into the folder we previously created "github-action-src"</span><br><span class="token comment"># you could also copy build files and such to "github-action-src" if you need to</span><br>cd github<span class="token punctuation">-</span>action<span class="token punctuation">-</span>src<br><br>npm install<br>node index.js</code></pre><p>If you have any question please send me a mail at <a href="mailto:oss@thoughtsunificator.me">oss@thoughtsunificator.me</a>.</p></div></article></main><footer id="footer"><small>Built using <a href="https://www.11ty.dev/" rel="noreferrer" target="_blank">Eleventy</a></small> <small class="copyright">© <a href="https://thoughtsunificator.me" rel="author" target="_blank">Romain Lebesle</a></small><div class="icons"><a href="https://twitter.com/thoughtsunifier" rel="noopener" target="_blank" title="Twitter"><img alt="Twitter Profile" src="/image/twitter.svg" width="32"></a><a href="https://github.com/thoughtsunificator" rel="noopener" target="_blank" title="Github"><img alt="View source code on Github" src="/image/github.svg" width="32"></a></div></footer></body></html>